<?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;
use Illuminate\Support\Facades\DB;

class DomainTldSeeder extends Seeder
{
    public function run(): void
    {
        $tlds = [
            [
                "name" => ".bd",
                "status" => "active",
                "prices" => [
                    [1, 2000, 2500], [2, 4000, 5000], [3, 6000, 7500], [4, 8000, 10000],
                    [5, 10000, 12500], [6, 12000, 15000], [7, 14000, 17500], [8, 16000, 20000],
                    [9, 18000, 22500], [10, 20000, 25000]
                ]
            ],
            [
                "name" => ".com.bd",
                "status" => "active",
                "prices" => [
                    [1,1100,1600],[2,2200,3200],[3,3300,4800],[4,4400,6400],[5,5500,8000],
                    [6,6600,9600],[7,7700,11200],[8,8800,12800],[9,9900,14400],[10,11000,16000]
                ]
            ],
            [
                "name" => ".net.bd",
                "status" => "active",
                "prices" => [
                    [1,1100,1600],[2,2200,3200],[3,3300,4800],[4,4400,6400],[5,5500,8000],
                    [6,6600,9600],[7,7700,11200],[8,8800,12800],[9,9900,14400],[10,11000,16000]
                ]
            ],
            [
                "name" => ".info.bd",
                "status" => "active",
                "prices" => [
                    [1,1100,1600],[2,2200,3200],[3,3300,4800],[4,4400,6400],[5,5500,8000],
                    [6,6600,9600],[7,7700,11200],[8,8800,12800],[9,9900,14400],[10,11000,16000]
                ]
            ],
            [
                "name" => ".org.bd",
                "status" => "active",
                "prices" => [
                    [1,1100,1600],[2,2200,3200],[3,3300,4800],[4,4400,6400],[5,5500,8000],
                    [6,6600,9600],[7,7700,11200],[8,8800,12800],[9,9900,14400],[10,11000,16000]
                ]
            ],
            [
                "name" => ".edu.bd",
                "status" => "active",
                "prices" => [
                    [1,1100,1600],[2,2200,3200],[3,3300,4800],[4,4400,6400],[5,5500,8000],
                    [6,6600,9600],[7,7700,11200],[8,8800,12800],[9,9900,14400],[10,11000,16000]
                ]
            ],
            [
                "name" => ".id.bd",
                "status" => "coming_soon",
                "prices" => [
                    [1,1100,1600],[2,2200,3200],[3,3300,4800],[4,4400,6400],[5,5500,8000],
                    [6,6600,9600],[7,7700,11200],[8,8800,12800],[9,9900,14400],[10,11000,16000]
                ]
            ],
            [
                "name" => ".sch.bd",
                "status" => "coming_soon",
                "prices" => [
                    [1,1100,1600],[2,2200,3200],[3,3300,4800],[4,4400,6400],[5,5500,8000],
                    [6,6600,9600],[7,7700,11200],[8,8800,12800],[9,9900,14400],[10,11000,16000]
                ]
            ],
            [
                "name" => ".tv.bd",
                "status" => "coming_soon",
                "prices" => [
                    [1,12000,15000],[2,24000,30000],[3,36000,45000],[4,48000,60000],[5,60000,75000],
                    [6,72000,90000],[7,84000,105000],[8,96000,120000],[9,108000,135000],[10,120000,150000]
                ]
            ],
            [
                "name" => ".co.bd",
                "status" => "coming_soon",
                "prices" => [
                    [1,5000,5500],[2,10000,11000],[3,15000,16500],[4,20000,22000],[5,25000,27500],
                    [6,30000,33000],[7,35000,38500],[8,40000,44000],[9,45000,49500],[10,50000,55000]
                ]
            ],
            [
                "name" => ".ai.bd",
                "status" => "coming_soon",
                "prices" => [
                    [1,4000,5000],[2,8000,10000],[3,12000,15000],[4,16000,20000],[5,20000,25000],
                    [6,24000,30000],[7,28000,35000],[8,32000,40000],[9,36000,45000],[10,40000,50000]
                ]
            ]
        ];

        foreach ($tlds as $tld) {

            $name = $tld['name'];

            // Insert or update TLD
            DB::table('domain_tlds')->updateOrInsert(
                ['name' => $name], // unique key condition
                [
                    'status' => $tld['status'],
                    'updated_at' => now(),
                    'created_at' => now()
                ]
            );

            $tldId = DB::table('domain_tlds')->where('name', $name)->value('id');

            // Remove old prices so duplicate years don't error
            DB::table('domain_tld_prices')->where('tld_id', $tldId)->delete();

            // Insert fresh prices
            foreach ($tld['prices'] as $price) {
                DB::table('domain_tld_prices')->insert([
                    'tld_id' => $tldId,
                    'years' => $price[0],
                    'register_price' => $price[1],
                    'renewal_price' => $price[2],
                    'created_at' => now(),
                    'updated_at' => now()
                ]);
            }
        }
    }
}
